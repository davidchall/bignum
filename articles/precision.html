<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Control the displayed precision • bignum</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Control the displayed precision">
<meta property="og:description" content="bignum">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bignum</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/type-hierarchy.html">Hierarchy of data types</a>
    </li>
    <li>
      <a href="../articles/precision.html">Control the displayed precision</a>
    </li>
    <li>
      <a href="../articles/operations.html">Supported operations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/davidchall/bignum/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="precision_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Control the displayed precision</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/davidchall/bignum/blob/master/vignettes/precision.Rmd"><code>vignettes/precision.Rmd</code></a></small>
      <div class="hidden name"><code>precision.Rmd</code></div>

    </div>

    
    
<p>The <code><a href="../reference/biginteger.html">biginteger()</a></code> and <code><a href="../reference/bigfloat.html">bigfloat()</a></code> vectors are capable of storing numeric data at very high precision. Showing the full precision can quickly become overwhelming, so bignum provides tools to control the precision displayed in the console.</p>
<p>These tools were strongly inspired by how the excellent <a href="https://pillar.r-lib.org">pillar</a> package formats base R numeric vectors – in particular <code><a href="https://pillar.r-lib.org/articles/digits.html">vignette("digits", package = "pillar")</a></code> and <code><a href="https://pillar.r-lib.org/articles/numbers.html">vignette("numbers", package = "pillar")</a></code>. Indeed, this vignette follows the structure of those vignettes. Standing on the shoulders of giants…</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://davidchall.github.io/bignum/">bignum</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pillar.r-lib.org/">pillar</a></span><span class="op">)</span></code></pre></div>
<div id="standalone-vectors" class="section level2">
<h2 class="hasAnchor">
<a href="#standalone-vectors" class="anchor"></a>Standalone vectors</h2>
<div id="default-formatting" class="section level3">
<h3 class="hasAnchor">
<a href="#default-formatting" class="anchor"></a>Default formatting</h3>
<p>Similar to pillar, the default formatting of bignum vectors is determined by two options.</p>
<ul>
<li>The <code>"bignum.sigfig"</code> option controls the number of significant figures (digits) displayed. The default value is 7.</li>
<li>The <code>"bignum.max_dec_width"</code> option controls how wide the decimal notation can become before switching to scientific notation. The default value is 13.</li>
</ul>
<p>To demonstrate the default formatting, here are the first 7 significant figures of pi:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bigpi</span>
<span class="co">#&gt; &lt;bigfloat[1]&gt;</span>
<span class="co">#&gt; [1] 3.141593</span></code></pre></div>
<p>We can increase the displayed precision via the <code>"bignum.sigfig"</code> option:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>bignum.sigfig <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">bigpi</span>
<span class="co">#&gt; &lt;bigfloat[1]&gt;</span>
<span class="co">#&gt; [1] 3.141592654</span></code></pre></div>
<p>Formatting using significant figures controls the total number of digits displayed (<em>before and after</em> the decimal point), but it will always show every digit <em>before</em> the decimal point.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>bignum.sigfig <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/bigfloat.html">bigfloat</a></span><span class="op">(</span><span class="fl">1.2345</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;bigfloat[6]&gt;</span>
<span class="co">#&gt; [1] 0.123 1.23  12.3  123.  1235. 12345</span></code></pre></div>
<p>An important exception is that terminal zeros are only shown if there are non-zero digits beyond the displayed significant figures.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>bignum.sigfig <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
<span class="fu"><a href="../reference/bigfloat.html">bigfloat</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1e-3</span>, <span class="fl">1e-7</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;bigfloat[3]&gt;</span>
<span class="co">#&gt; [1] 1        1.001    1.000000</span></code></pre></div>
<p>The <code>"bignum.max_dec_width"</code> option controls how wide the output can be (including the decimal point) before it switches to scientific notation. It makes the decision based on the widest value in the vector.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bigfloat.html">bigfloat</a></span><span class="op">(</span><span class="fl">1234567890123</span><span class="op">)</span>
<span class="co">#&gt; &lt;bigfloat[1]&gt;</span>
<span class="co">#&gt; [1] 1234567890123</span>
<span class="fu"><a href="../reference/bigfloat.html">bigfloat</a></span><span class="op">(</span><span class="fl">1234567890123.4</span><span class="op">)</span>
<span class="co">#&gt; &lt;bigfloat[1]&gt;</span>
<span class="co">#&gt; [1] 1.234568e+12</span>
<span class="fu"><a href="../reference/bigfloat.html">bigfloat</a></span><span class="op">(</span><span class="fl">12345678901234</span><span class="op">)</span>
<span class="co">#&gt; &lt;bigfloat[1]&gt;</span>
<span class="co">#&gt; [1] 1.234568e+13</span></code></pre></div>
</div>
<div id="custom-formatting" class="section level3">
<h3 class="hasAnchor">
<a href="#custom-formatting" class="anchor"></a>Custom formatting</h3>
<p>Sometimes you want more specific formatting, or to apply formatting to a single vector without changing global options. This is achieved using the <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> function (see <code><a href="../reference/bignum-format.html">help("bignum-format")</a></code>).</p>
<p>The default formatting demonstrated above chooses between decimal and scientific notation, depending on how wide the output is and the <code>"bignum.max_dec_width"</code> option. The <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> function provides a <code>notation</code> argument to override this decision.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bigfloat.html">bigfloat</a></span><span class="op">(</span><span class="fl">1.2345</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">x</span>, notation <span class="op">=</span> <span class="st">"dec"</span><span class="op">)</span>
<span class="co">#&gt; [1] "0.12345" "1.2345"  "12.345"  "123.45"  "1234.5"  "12345"</span>
<span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">x</span>, notation <span class="op">=</span> <span class="st">"sci"</span><span class="op">)</span>
<span class="co">#&gt; [1] "1.2345e-01" "1.2345e+00" "1.2345e+01" "1.2345e+02" "1.2345e+03"</span>
<span class="co">#&gt; [6] "1.2345e+04"</span></code></pre></div>
<p>The default formatting also decides the total number of digits to show based on the <code>"bignum.sigfig"</code> option. The <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> function supports overriding this value using the <code>sigfig</code> argument.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">x</span>, sigfig <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; [1] "0.123" "1.23"  "12.3"  "123."  "1235." "12345"</span></code></pre></div>
<p>But <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> also supports specifying how many digits to display <em>after</em> the decimal point, using the <code>digits</code> argument. If the value is positive, we show <em>exactly</em> that many digits. If the value is negative, we show <em>at most</em> that many digits (i.e. terminal zeros can be hidden).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; [1] "0.12"     "1.23"     "12.35"    "123.45"   "1234.50"  "12345.00"</span>
<span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; [1] "0.12"   "1.23"   "12.35"  "123.45" "1234.5" "12345"</span></code></pre></div>
</div>
</div>
<div id="tibble-columns" class="section level2">
<h2 class="hasAnchor">
<a href="#tibble-columns" class="anchor"></a>Tibble columns</h2>
<p>The <a href="https://tibble.tidyverse.org">tibble</a> package allows bignum vectors to be stored in a data frame. When a tibble is printed, the vector values are displayed vertically as a column. Consequently, the default formatting is adjusted to make the data easier to read vertically.</p>
<p>When stored as a tibble column, the bignum vector formatting consults two options. <strong>Note:</strong> These options are different from those used for formatting standalone vectors, because they reside within the pillar package (see <code><a href="https://pillar.r-lib.org/reference/pillar-package.html">help("pillar-package")</a></code>).</p>
<ul>
<li>The <code>"pillar.sigfig"</code> option controls the number of significant figures (digits) displayed. The default value is 3.</li>
<li>The <code>"pillar.max_dec_width"</code> option controls how wide the decimal notation can become before switching to scientific notation. The default value is 13.</li>
</ul>
<p>We use the <code><a href="https://pillar.r-lib.org/reference/pillar.html">pillar()</a></code> function to demonstrate tibble columns without the overhead of the tibble package.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://pillar.r-lib.org/reference/pillar.html">pillar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; &lt;pillar&gt;</span>
<span class="co">#&gt;  &lt;bigflt&gt;</span>
<span class="co">#&gt;     0.123</span>
<span class="co">#&gt;     1.23 </span>
<span class="co">#&gt;    12.3  </span>
<span class="co">#&gt;   123.   </span>
<span class="co">#&gt;  1235.   </span>
<span class="co">#&gt; 12345</span></code></pre></div>
<p>We can increase the displayed precision via the <code>"pillar.sigfig"</code> option:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>pillar.sigfig <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://pillar.r-lib.org/reference/pillar.html">pillar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; &lt;pillar&gt;</span>
<span class="co">#&gt;   &lt;bigflt&gt;</span>
<span class="co">#&gt;     0.1235</span>
<span class="co">#&gt;     1.235 </span>
<span class="co">#&gt;    12.35  </span>
<span class="co">#&gt;   123.4   </span>
<span class="co">#&gt;  1235.    </span>
<span class="co">#&gt; 12345</span></code></pre></div>
<p>Since the formatted data is aligned on the decimal point, the <code>"pillar.max_dec_width"</code> option works differently from <code>"bignum.max_dec_width"</code>. One row might have many digits on the left of the point, and another row might have many digits on the right of the point (see example above). The total width calculation accounts for both extremes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>pillar.max_dec_width <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>
<span class="fu"><a href="https://pillar.r-lib.org/reference/pillar.html">pillar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; &lt;pillar&gt;</span>
<span class="co">#&gt; &lt;bigflt&gt;</span>
<span class="co">#&gt; 1.235e-1</span>
<span class="co">#&gt; 1.235e+0</span>
<span class="co">#&gt; 1.235e+1</span>
<span class="co">#&gt; 1.234e+2</span>
<span class="co">#&gt; 1.234e+3</span>
<span class="co">#&gt; 1.234e+4</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Hall.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
